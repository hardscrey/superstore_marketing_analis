# Superstore Marketing Analysis

## Цель проекта:
- Провести маркетинговый анализ продаж (категории, сезонность, KPI).
- Выполнить RFM-анализ для сегментации клиентов.
- Провести A/B-тест по влиянию скидок на прибыль.

Основные задачи:
- Анализ структуры и динамики продаж;
- Определение ключевых категорий и продуктов по прибыли;
- Анализ сезонности;
- Проведение RFM-анализа клиентов;
- Проверка гипотезы о влиянии скидок (A/B-тестирование);
- Формулировка рекомендаций по повышению прибыльности.

---

## Используемые библиотеки
`pandas`, `numpy`, `matplotlib`, `seaborn`, `scipy`, `statsmodels`

---

## 1. Предобработка и обзор данных
- Источник: [**Superstore Dataset**](data/README.md)
- Проверены типы данных, пропуски и дубликаты.  
- Добавлены признаки:
  - `Discount_group` — группы скидок;
  - `order_month`, `order_dow`, `order_week` — календарные признаки;
  - `margin` — отношение прибыли к продажам.

---

## 2. Анализ продаж и прибыли

### Основные результаты:
- Категории **Technology** и **Office Supplies** приносят наибольшую прибыль.
- Категория **Furniture** менее рентабельна из-за частых и больших скидок.

**Визуализации:**
[Прибыль по категориям](results/top_categories.csv)

| Category        | total_sales | avg_sales          | total_profit | orders | avg_discount        |
|-----------------|-------------|--------------------|--------------|--------|---------------------|
| Technology      | 836154.033  | 452.70927612344343 | 145454.9481  | 1847   | 0.1323226854358419  |
| Office Supplies | 719047.032  | 119.32410089611683 | 122490.8008  | 6026   | 0.15728509790906076 |
| Furniture       | 741999.7953 | 349.8348869872702  | 18451.2728   | 2121   | 0.1739226779820839  |

[Топ-5 продуктов по прибыли](results/top_products.csv)

| Product Name                                                                | Sub-Category | Category        | total_sales        | avg_sales          | total_profit | orders | avg_discount        |
|-----------------------------------------------------------------------------|--------------|-----------------|--------------------|--------------------|--------------|--------|---------------------|
| Canon imageCLASS 2200 Advanced Copier                                       | Copiers      | Technology      | 61599.824          | 12319.96         | 25199.928    | 5      | 0.120 |
| Fellowes PB500 Electric Punch Plastic Comb Binding Machine with Manual Bind | Binders      | Office Supplies | 27453.384 | 2745.34          | 7753.039     | 10     | 0.24                |
| Hewlett Packard LaserJet 3310 Copier                                        | Copiers      | Technology      | 18839.686          | 2354.96         | 6983.8836    | 8      | 0.2                 |
| Canon PC1060 Personal Laser Copier                                          | Copiers      | Technology      | 11619.834 | 2904.96 | 4570.9347    | 4      | 0.150 |
| HP Designjet T520 Inkjet Large Format Printer - 24"" Color                  | Machines     | Technology      | 18374.895          | 6124.97           | 4094.9766    | 3      | 0.167 |

---

## 3. Сезонность продаж
- Продажи растут к IV кварталу (октябрь–декабрь);
- Снижение активности наблюдается в летние месяцы;
- По дням недели: пик продаж — будни, спад — выходные.

**Графики:**
- `images/monthly_sales_profit.png`
- `images/sales_by_dow.png`

**Подтверждение сезонности:**
- Разложение временного ряда на тренд и сезонность;
- ADF-тест (проверка стационарности);
- Корреляция продаж с месяцем и неделей.

---

## 4. Ключевые KPI

| Метрика | Описание |
|----------|-----------|
| **AOV** | Средний чек (Sales / Orders) |
| **Margin** | Рентабельность (Profit / Sales) |
| **Discount** | Средний уровень скидки |
| **Profit per Order** | Средняя прибыль на заказ |

**Вывод:** увеличение скидки выше 30 % приводит к снижению маржи без значимого роста выручки.

Файлы:  
`results/kpi_by_category.csv`  
`images/kpi_dashboard.png`

---

## 5. RFM-анализ клиентов

- **Recency (R)** — давность последней покупки;  
- **Frequency (F)** — частота заказов;  
- **Monetary (M)** — общая сумма продаж.

Клиенты разделены на квартильные группы (1–4).  
Объединены в сегменты для оценки ценности и лояльности.

**Примеры сегментов:**
- `R=4, F=4, M=4` — лояльные и ценные клиенты (VIP);
- `R=1, F=1, M=1` — неактивные клиенты.

**Визуализация:**  
`images/rfm_distribution.png`  
**Результаты:** `results/rfm_base.csv`

---

## 6. A/B-анализ скидок

**Гипотеза H₀:** скидка не влияет на прибыль.  
**Гипотеза H₁:** наличие скидки снижает прибыль.

**Группы:**
- **A** — заказы без скидки (`Discount = 0`)
- **B** — заказы со скидкой (`Discount > 0`)

**Методы:**
- Welch’s t-test — для неравных дисперсий;  
- Mann-Whitney U-тест — непараметрический;  
- Bootstrap-оценка доверительного интервала разницы средних.

**Результаты (пример):**
| Группа | Средняя прибыль | Средняя скидка |
|---------|-----------------|----------------|
| A (без скидки) | 28.5 | 0 |
| B (со скидкой) | 23.9 | 0.25 |

**Разница:** −4.6 у.е.  
**p-value:** < 0.01  
→ Различие статистически значимо: скидки снижают прибыль.

**Графики:**
- `images/mean_profit_by_discount_group.png`
- `images/bootstrap_difference.png`

---

## 7. Регрессионный анализ

Модель:  
`Profit ~ Discount_group + Sales + Quantity + C(Category) + C(Region)`

**Основные выводы:**
- Скидка имеет отрицательный коэффициент при прочих равных;
- Категории *Technology* и *Office Supplies* положительно влияют на прибыль;
- Эффект скидок варьируется по регионам.

Файл: `results/regression_coefficients.csv`

---

## 8. Сегментный анализ и множественные гипотезы

Сравнение A/B-результатов по категориям и регионам.  
Применена FDR-коррекция (Benjamini–Hochberg).  

**Итог:** скидки особенно убыточны для *Furniture* и *Technology*.

Файлы:  
`results/category_ab_tests.csv`  
`results/category_ab_tests_adj.csv`

---

## 9. Power-анализ и симуляция эксперимента
Для эффекта среднего размера (Cohen’s d ≈ 0.3)  
необходимо минимум **175 наблюдений в каждой группе** при α = 0.05 и power = 0.8.

Проведено моделирование 500 экспериментов → устойчивость результатов подтверждена.

---

## 10. Основные выводы и рекомендации

**Инсайты:**
- Скидки не увеличивают прибыль, а в большинстве случаев уменьшают её;
- Наиболее прибыльные категории: *Technology*, *Office Supplies*;
- Пик продаж — IV квартал;
- Лояльные клиенты обеспечивают существенную долю выручки.

**Рекомендации:**
1. Сократить скидки > 30 %;
2. Персонализировать предложения для сегментов с высоким RFM-баллом;
3. Проводить маркетинговые кампании в пиковые сезоны;
4. Тестировать новые акции с контролем прибыли и ROI.

---

## 11. Структура проекта

